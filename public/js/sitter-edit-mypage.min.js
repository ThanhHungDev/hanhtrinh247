function chooseFile(){$("#avatars").click()}function saveImage(e){var i=new FormData;i.append("file",e);var a=APP_URL+"/sitter/upload-avatar";$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({type:"POST",url:a,data:i,enctype:"multipart/form-data",cache:!1,contentType:!1,processData:!1,success:function(e){var i=$(".js-waiting-ajax-save-image");if(200==e.code){i.addClass("itemRemove");var a=document.createElement("span");a.className="js_remove_img",a.value="js_remove_img",a.innerHTML='<i class="far fa-trash-alt"></i>',a.setAttribute("data-id-image",e.id),i.removeClass("js-waiting-ajax-save-image"),i.append(a),$(".js_loading_img").remove(),$.toast({heading:"成功",text:"画像をアップロードしました",showHideTransition:"slide",icon:"success",position:"top-right"})}else $.toast({heading:"エラー",text:"画像のアップロードに失敗しました",showHideTransition:"slide",icon:"error",position:"top-right"}),$(".js_loading_img").closest("li").remove()},error:function(e){$.toast({heading:"エラー",text:"画像のアップロードに失敗しました",showHideTransition:"slide",icon:"error",position:"top-right"}),$(".js_loading_img").closest("li").remove()}})}function readURL(e,i){if(e.files&&e.files[0]){var a=new FileReader;a.onload=function(a){if(a.target.result){var t=a.target.result,r=document.createElement("img");r.src=t;var s=document.createElement("div");s.className="wrapper-image-slide js-waiting-ajax-save-image";var n=document.createElement("span");n.className="js_loading_img",n.value="js_loading_img",s.appendChild(r),s.appendChild(n);var o=document.createElement("li");o.className="ui-state-default",o.appendChild(s),document.getElementById(i).insertBefore(o,document.getElementById(i).firstChild),saveImage(e.files[0])}},a.readAsDataURL(e.files[0])}else $.toast({heading:"エラー",text:"Error!",showHideTransition:"slide",icon:"error",position:"top-right"})}function loadImageInMypage(){$.ajax({type:"GET",url:APP_URL+"/sitter/load-avatars",dataType:"json",success:function(e){200==e.code?($slideImage1='<img class="icon-upload" id="upload-avatar" src="'+APP_URL+'/image/icons/icon-upload.png") >',$slideImage2="",$.each(e.data,function(e,i){$source1=APP_URL+"/storage/uploads/avatars/"+i.name,$source2=APP_URL+"/storage/uploads/avatars/thumbnail/"+i.name,$slideImage1+='<img src="'+$source1+'">',$slideImage2+='<img src="'+$source2+'">'}),$("#slider").empty(),$("#slider-nav").empty(),$("#slider").removeClass("slick-initialized slick-slider").append($slideImage1),$("#slider-nav").removeClass("slick-initialized slick-slider").append($slideImage2),runSlide()):$.toast({heading:"エラー",text:"エラー",showHideTransition:"slide",icon:"error",position:"top-right"})},error:function(e){$.toast({heading:"エラー",text:"エラー",showHideTransition:"slide",icon:"error",position:"top-right"})}})}function runSlide(){$("#slider").slick({slidesToShow:1,slidesToScroll:1,fade:!0,asNavFor:"#slider-nav",infinite:!0,autoplay:!0,pauseOnHover:!0,swipe:!0}),$("#slider-nav").slick({asNavFor:"#slider",dots:!0,infinite:!0,slidesToShow:1,centerMode:!0,variableWidth:!0,autoplay:!0})}$(document).ready(function(){function e(){var e=[];$("#sitter-skills li").each(function(){if($(this).hasClass("active")){var i=$(this).attr("data-value");e.push(i)}}),$("#skills").val(e)}function i(){1==parseInt($("#exp_parenting").val())?$("#kid_qty").attr("disabled",!1):($("#kid_qty option:first").prop("selected",!0),$("#kid_qty").attr("disabled",!0))}e(),i(),$("#sitter-skills li").on("click",function(i){$(this).toggleClass("active"),e(),$("#skills").valid()}),$("#exp_parenting").on("change",function(e){i()}),$("#slider").on("click",function(){$("#modalShowAvatars").modal("show")}),$("#modalShowAvatars").on($.modal.BEFORE_CLOSE,function(){loadImageInMypage()}),$("input").keypress(function(e){13==e.keyCode&&e.preventDefault()});let a=$("#sitter-edit-form");$.validator.setDefaults({ignore:[":disabled"]}),a.validate({onfocusout:function(e){$(e).valid()},focusInvalid:!1,invalidHandler:function(){$(this).find(".form-validate .error:first").focus()},rules:{age:"required",pref:"required",city:{required:{depends:function(){return $.trim($(this).val())||$(this).val($.trim($(this).val())),!0}},minlength:1,maxlength:255},kid_age_start:"required",kid_age_end:"required",kid_age:{checkKidAge:!0},kid_qty:"required",exp_parenting:"required",exp_sitter:"required",time_support:"required",salary_sitter:"required",salary_house:"required",self_introduce:"required",service_introduce:"required",skills:{required:!0},schedule:{checkSchedules:!0},check_time:{checkValidTime:!0}},messages:{age:{required:"この項目は必須です"},pref:{required:"この項目は必須です"},city:{required:"この項目は必須です",minlength:"この項目は1桁以上、255桁以下でなければなりません。",maxlength:"この項目は1桁以上、255桁以下でなければなりません。"},kid_age_start:{required:"この項目は必須です"},kid_age_end:{required:"この項目は必須です"},kid_age:{checkKidAge:"保育可能年齢が不正です。"},kid_qty:{required:"この項目は必須です"},exp_sitter:{required:"この項目は必須です"},exp_parenting:{required:"この項目は必須です"},exp_sitter:{required:"この項目は必須です"},time_support:{required:"この項目は必須です"},salary_sitter:{required:"この項目は必須です"},salary_house:{required:"この項目は必須です"},self_introduce:{required:"この項目は必須です"},service_introduce:{required:"この項目は必須です"},skills:{required:"この項目は必須です"},schedule:{checkSchedules:"この項目は必須です"},check_time:{checkValidTime:"終了時間は開始時間より後でなければなりません。"}},errorPlacement:function(e,i){(i=i.closest(".form-validate").find(".form-error")).html(""),e.appendTo(i)}})}),$.validator.addMethod("checkKidAge",function(){return $ageStart=parseInt($("#kid_age_start").val()),$ageEnd=parseInt($("#kid_age_end").val()),!($ageStart&&$ageEnd&&$ageStart>$ageEnd)}),$.validator.addMethod("checkSchedules",function(){return $schedules=JSON.parse($("#sitter-mypage-edit #js-event-data").val()),!jQuery.isEmptyObject($schedules)}),$.validator.addMethod("checkValidTime",function(){return!!$("#js-modal-calendar").hasClass("d-none")||checkValidTime()}),$("#kid_age_start, #kid_age_end").on("change",function(){$("#kid_age").valid()}),$(document).on("input","#js-hour-begin, #js-minute-begin, #js-hour-end, #js-minute-end",function(e){var i=$(this).val();return i.length>=2&&(i=i.substr(0,2)),$(this).val(i),$("#check-time").valid(),!1}),$("#showImage").on("click",".js_remove_img",function(){var e=$(this),i=e.attr("data-id-image");e.closest("ul");e.closest("li").remove(),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({type:"POST",url:APP_URL+"/sitter/remove-avatar",data:{imageId:i},dataType:"json",success:function(e){200==e.code?$.toast({heading:"成功",text:"画像を削除しました",showHideTransition:"slide",icon:"success",position:"top-right"}):$.toast({heading:"エラー",text:"画像を削除に失敗しました",showHideTransition:"slide",icon:"error",position:"top-right"})},error:function(e){$.toast({heading:"エラー",text:"画像を削除に失敗しました",showHideTransition:"slide",icon:"error",position:"top-right"})}})});